<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BNB Chain Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BNB Chain Documentation Atom Feed"><title data-react-helmet="true">Scaling | BNB Chain Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://github.com/RumeelHussainbnb/beta_BSC_Docs/docs/dev-outlook/scaling"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Scaling | BNB Chain Documentation"><meta data-react-helmet="true" name="description" content="BSC Throughput Boost"><meta data-react-helmet="true" property="og:description" content="BSC Throughput Boost"><link data-react-helmet="true" rel="shortcut icon" href="/img/icon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/RumeelHussainbnb/beta_BSC_Docs/docs/dev-outlook/scaling"><link data-react-helmet="true" rel="alternate" href="https://github.com/RumeelHussainbnb/beta_BSC_Docs/docs/dev-outlook/scaling" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/RumeelHussainbnb/beta_BSC_Docs/docs/dev-outlook/scaling" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.89c2ba9f.css">
<link rel="preload" href="/assets/js/runtime~main.08a3f3ce.js" as="script">
<link rel="preload" href="/assets/js/main.30a9ffb2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/image.png" alt="BNB" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/image.png" alt="BNB" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">BNB Chain Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">BNB Chain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorials">Tutorials</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Future Developments</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">2022 Development Outlook</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dev-outlook-2022">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/dev-outlook/scaling">Scaling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dev-outlook/user-exp">User Experience</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dev-outlook/sharding-and-multichain">Sharding and Multi-chain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dev-outlook/community">Community</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FAQs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contribute">How to Contribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/more-help">More Help</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Scaling</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="bsc-throughput-boost">BSC Throughput Boost<a aria-hidden="true" class="hash-link" href="#bsc-throughput-boost" title="Direct link to heading">‚Äã</a></h2><p>Though many have challenged that BSC chose to scale up the capacity by shorter block time and larger block gas limit. There is strong faith that there is still room to improve the capacity of the current PoSA based BSC.</p><p>Based on the past research and investigation, storage has been commonly considered as the major bottleneck. The 17TB data of a BSC archive node / 2TB for a full node on one machine is not sustainable. As a result, storage optimization is the main focus as well.</p><p><img src="https://aws1.discourse-cdn.com/standard11/uploads/binancesmartchain1/original/1X/d177780f6baa8cfe6c6b5761b08b980d51cabcee.jpeg" alt="storage-stats"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="erigon-based-bsc-client-or-another-storage-model">Erigon Based BSC Client or Another Storage Model<a aria-hidden="true" class="hash-link" href="#erigon-based-bsc-client-or-another-storage-model" title="Direct link to heading">‚Äã</a></h2><p><a href="https://github.com/ledgerwatch/erigon" target="_blank" rel="noopener noreferrer">Erigon</a>, a.k.a the previous ‚Äúturbo-geth‚Äù, has been striving hard to improve the storage system of Ethereum/Geth in the past 3 years and now blossomed into beta status. Its new storage model with the new database, MPT generation methodology and staged sync has been proven to run much more efficiently than Geth for the large storage. Creating a BSC client based on Erigon will certainly improve the efficiency of the BSC archive node by reducing the storage size and improving the sync time.</p><p><a href="https://github.com/binance-chain/bsc-erigon" target="_blank" rel="noopener noreferrer">Ankr is already contributing to the task</a>. The full node binary is ready to run while the validator mode is being worked on.</p><p>Besides the instant benefits, the new storage model of Erigon may also set a better cornerstone for the other storage related optimizations.</p><p>One shortcoming of Erigon is that it doesn‚Äôt support Snapshot Sync yet, which is a must for BSC node runners. The BSC community will work with Erigon to overcome this in 2022.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="distributed-node">Distributed Node<a aria-hidden="true" class="hash-link" href="#distributed-node" title="Direct link to heading">‚Äã</a></h2><p>For high performance computing, it is almost impossible to only rely on one node nowadays. The principle of BSC is to allow the node runners to use multiple servers with common hardware specs to support the network, instead of one ‚Äúbare-metal‚Äù super machine.</p><p>Running different functions of a blockchain client on different processes or machines are not new. Erigon proposes to run the RPC function in a standalone process on the same or different machine. The Merge of ETH 2.0 will also decompose the consensus and execution layers onto different client softwares.</p><p>A typical blockchain client comprises many functionalities, P2P networking, consensus, RPC service, execution layer etc. Even zooming in these parts, e.g. the execution layer, is composed of many steps, such as the computing of transactions, the state persistence and the generation of different MPT(Merkle Patricia Trie) roots. Decoupling the functions onto different processes and machines can take advantage of the better computing and storage capacity. Some community members have started <a href="https://github.com/binance-chain/bsc/pull/640" target="_blank" rel="noopener noreferrer">some trials</a>. However, distributing the node also poses great challenges, especially on synchronization between the distributed sub-nodes without losing the blockchain network security, i.e. the full node operators can easily run the suite of processes to keep the network running with the same level of security but much more capacity.</p><p>A straightforward approach may be to arrange the tasks in a ‚Äúsynchronized, distributed, assembly line‚Äù (SDAL), due to the sequential characteristics of the blockchain. Some change may be required on the consensus logic to make this type optimization easier. This is also discussed in other blockchains that break sequencing, execution and storage (settlement) into different components.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ephemeral-client-and-hotcold-data-segregation">Ephemeral Client and Hot/Cold Data Segregation<a aria-hidden="true" class="hash-link" href="#ephemeral-client-and-hotcold-data-segregation" title="Direct link to heading">‚Äã</a></h2><p>One foreseeable problem of the current public blockchain is that it stores ALL the data FOREVER. It is very likely that only 20% of the state in the EVM blockchain is still useful, while 80% may not be used much anymore. BSC has more than 121 million unique addresses in Dec. 2021, while daily active addresses are only over 2 million. Many data were created on the blockchain for just one time use and the creators do not bother with calling the SELF DESTRUCT instruction. But the data will be there forever, and accumulated only to break the bones of the archive node.</p><p>Ideally there should be an ‚ÄúEphemeral Client‚Äù, which is a mode between a ‚Äúfull node‚Äù and a ‚Äúlight client‚Äù:</p><p>Ephemeral Client starts with a much smaller snapshot of the blockchain, which only contains state of the accounts and contracts that are active in the past 2 weeks or 1 months, with only recent block bodies, headers and receipts, with all other data excluded;
The excluded accounts and contracts will only be presented as intermediate node of MPT, so that they can still be used to calculate the new MPT;
Ephemeral Client can work in a similar way as a full node, in the sense that it will execute all the transactions and verify all the data. It should load the excluded data during the execution from another full node or the Portal Network, or even pre-load the excluded data based on the transactions in the mempool.
Apparently sometimes the ephemeral clients may run slower than a full node, but it is a trade-off to make it much easier to run, and run faster.</p><p>Deriving from this concept, it is natural to consider separating the hot data from the cold data, which has been a classic technique used in the computing industry. If the EVM blockchain is considered as a ‚Äúworld computer‚Äù, the memory of the node should be the registers, while the storage can be the RAM (yes, with MPT used in a similar way as ECC in RAM). RAM has never been big enough, so that the data has to be swapped out onto local or/and remote disks. The EVM blockchain needs such ‚Äúlocal or/and remote disks‚Äù too.</p><p>This is not an easy problem to solve:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">1. Data location is not part of the consensus. It may be easy to mark the data as ‚Äúswap-out‚Äù or ‚Äúoffline‚Äù and reach the consensus, but the more important issue is to reach the implicit consensus that ‚Äúmy proposed block has some transactions that swap in data from the offline mode‚Äù. The short blocking time may not be enough from other validators to respond.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Some contracts may have a very big storage, which is a great help to swap it out, but very challenging to swap it in as a whole back to ‚Äúonline‚Äù.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>One potential solution may be:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">1. Swap the data out by the unit of account and contract when they have not been changed for a long time, and put this as an transaction to get consensus;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Swap in data by a deterministic set size, which may not be as large as the whole contract data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. The swapped-in data can be passed in as extra calldata on the block, and the other validators can execute the transactions and verify the data as a ‚Äústateless client‚Äù if they cannot load the data in time.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. The transaction senders will pay extra gas to run any transaction that requires swapping in the data.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A new data layer may emerge due to the requirement to store the cold data.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="evm-parallelization">EVM Parallelization<a aria-hidden="true" class="hash-link" href="#evm-parallelization" title="Direct link to heading">‚Äã</a></h2><p>Running transactions in parallel for Ethereum has been studied for several years. Solana goes with a native design to enable this as much as possible so that it can take advantage of the powerful GPU.</p><p>Based on the analytics of BSC data, the CPU has not been the No.1 bottleneck but the storage is. Even though the EVM parallelization will take better usage of multiple cores of the modern CPUs, the primary goal is to increase the parallelism of storage operation to maximize the SSD usage (even the SATA ones).</p><p>In order to maintain backwards compatibility and not change the account structures as Solana does, the most straightforward method is heuristic based, i.e. try-and-rerun-the-failed. The full nodes can do some preprocessing to categorize the transactions in the blocks and mempool into different concurrent workers before actually running them. A lower level instrument monitor will be planted at the storage level, if the race condition is detected, and relevant transactions will be put back into the main worker to rerun in order to generate the correct state. Block producers may even place some hints for others to run the blocks in the most efficient way via the P2P network, though the hint itself is not part of the block.</p><p>Besides the parallelization within one block, BSC inherits one limit from Ethereum that the block proposer has to wait until it applies all the previous blocks before it can execute any transactions in its block to propose at its turn. If the previous block proposers send the block late, or the blocks are delayed due to slow network etc, the proposer may not have enough time to execute enough transactions into their blocks and have to propose an empty block or even miss its turn. Tendermint is a good example that solves the above issue. The block proposer on Tendermint network only needs to assemble the block without executing them. How to control the gas used within one block without executing transactions is a difficult topic on the EVM network.</p><p>How to run transactions in parallel even among different blocks will be very rewarding here, but it will be very difficult as well.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="evm-jit-compilation">EVM JIT Compilation<a aria-hidden="true" class="hash-link" href="#evm-jit-compilation" title="Direct link to heading">‚Äã</a></h2><p>Using JIT compilation in EVM was <a href="https://github.com/ethereum/evmjit" target="_blank" rel="noopener noreferrer">proposed</a> and <a href="https://ethresear.ch/t/evm-performance/2791" target="_blank" rel="noopener noreferrer">discussed</a> in the early days of Ethereum. When popular dApps dominate the network, such as OpenSea and Uniswap on Ethereum, and PancakeSwap on BSC, and one GameFi dApp had a few million transactions per day, the idea is fascinating that these applications can be compiled into native instructions and able to run faster. This benefits even the compilation is not done ‚Äújust-in-time‚Äù but offline.</p><p>However, this is a very challenging feature because it touches the very low level of EVM and can be quite prone to error and security issues. Here is just a placeholder for the talented developers to conquer in the later stage.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/RumeelHussainbnb/beta_BSC_Docs/blob/master/docs/dev-outlook/scaling.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/dev-outlook-2022"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/dev-outlook/user-exp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">User Experience<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#bsc-throughput-boost" class="table-of-contents__link toc-highlight">BSC Throughput Boost</a></li><li><a href="#erigon-based-bsc-client-or-another-storage-model" class="table-of-contents__link toc-highlight">Erigon Based BSC Client or Another Storage Model</a></li><li><a href="#distributed-node" class="table-of-contents__link toc-highlight">Distributed Node</a></li><li><a href="#ephemeral-client-and-hotcold-data-segregation" class="table-of-contents__link toc-highlight">Ephemeral Client and Hot/Cold Data Segregation</a></li><li><a href="#evm-parallelization" class="table-of-contents__link toc-highlight">EVM Parallelization</a></li><li><a href="#evm-jit-compilation" class="table-of-contents__link toc-highlight">EVM JIT Compilation</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/bnbIntro">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.buildnbuild.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>BuildnBuild Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.bnbchain.org/en/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/bnb-chain" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.com/invite/bnbchain" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/BNBCHAIN" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://t.me/BinanceDEXchange" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Build N Build.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.08a3f3ce.js"></script>
<script src="/assets/js/main.30a9ffb2.js"></script>
</body>
</html>